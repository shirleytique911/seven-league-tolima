;/*FB_PKG_DELIM*/

__d("CometFeedStory3DPhotoAttachmentStyle_styleTypeRenderer$normalization.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},d={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"owner",plural:!1,selections:[a,c,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"uri_token",storageKey:null}],type:"Page",abstractKey:null}],storageKey:null},e=[c];return{kind:"SplitOperation",metadata:{},name:"CometFeedStory3DPhotoAttachmentStyle_styleTypeRenderer$normalization",selections:[{alias:null,args:null,concreteType:"StoryAttachment",kind:"LinkedField",name:"attachment",plural:!1,selections:[{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"description",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"target",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Story",kind:"LinkedField",name:"container_story",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actors",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:[{kind:"Literal",name:"height",value:48},{kind:"Literal",name:"width",value:48}],concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:[b],storageKey:"profile_picture(height:48,width:48)"},c],storageKey:null},c],storageKey:null}],type:"Photo",abstractKey:null},c],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media",plural:!1,selections:[a,{alias:"photo_image",args:[{kind:"Variable",name:"scale",variableName:"scale"},{kind:"Literal",name:"sizing",value:"cover-fill"},{kind:"Literal",name:"width",value:500}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:[b,{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isMedia"},{alias:null,args:null,kind:"ScalarField",name:"is_playable",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"accessibility_caption",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"immersive_photo_encodings",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"projection_type",storageKey:null},c,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"binary_cdn_uri",storageKey:null}],type:"PhotoEncoding3D",abstractKey:null}],storageKey:null},c,d],type:"Photo",abstractKey:null},{kind:"InlineFragment",selections:[c,d],type:"Video",abstractKey:null},{kind:"InlineFragment",selections:e,type:"Node",abstractKey:"__isNode"},{kind:"InlineFragment",selections:e,type:"DynamicFeedAdAttachmentMedia",abstractKey:null},{kind:"InlineFragment",selections:e,type:"GenericAttachmentMedia",abstractKey:null},{kind:"InlineFragment",selections:e,type:"MontageImage",abstractKey:null},{kind:"InlineFragment",selections:e,type:"MontageVideo",abstractKey:null}],storageKey:null}],storageKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,kind:"ScalarField",name:"is_prod_eligible",storageKey:null}],type:"StoryAttachmentStyleRendererUnion",abstractKey:"__isStoryAttachmentStyleRendererUnion"}]}}();e.exports=a}),null);
__d("CometFeedStory3DPhotoAttachmentStyle_styleTypeRenderer.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};c=[c,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"owner",plural:!1,selections:[b,c,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"uri_token",storageKey:null}],type:"Page",abstractKey:null}],storageKey:null}];return{argumentDefinitions:[{kind:"RootArgument",name:"scale"}],kind:"Fragment",metadata:null,name:"CometFeedStory3DPhotoAttachmentStyle_styleTypeRenderer",selections:[{args:null,kind:"FragmentSpread",name:"useCometFeedStoryAttachmentMatchDebugger_storyAttachmentStyleRendererUnion"},{alias:null,args:null,concreteType:"StoryAttachment",kind:"LinkedField",name:"attachment",plural:!1,selections:[{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"description",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"target",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Story",kind:"LinkedField",name:"container_story",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actors",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:[{kind:"Literal",name:"height",value:48},{kind:"Literal",name:"width",value:48}],concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:[a],storageKey:"profile_picture(height:48,width:48)"}],storageKey:null}],storageKey:null}],type:"Photo",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media",plural:!1,selections:[b,{alias:"photo_image",args:[{kind:"Variable",name:"scale",variableName:"scale"},{kind:"Literal",name:"sizing",value:"cover-fill"},{kind:"Literal",name:"width",value:500}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"accessibility_caption",storageKey:null}],type:"Photo",abstractKey:null},{args:null,kind:"FragmentSpread",name:"CometRemote3DPhotoViewer_photo"},{kind:"InlineDataFragmentSpread",name:"getCometMediaURL_media",selections:[{alias:null,args:null,kind:"ScalarField",name:"is_playable",storageKey:null},{kind:"InlineFragment",selections:c,type:"Photo",abstractKey:null},{kind:"InlineFragment",selections:c,type:"Video",abstractKey:null}],args:null,argumentDefinitions:[]}],storageKey:null}],storageKey:null}],type:"StoryAttachment3DPhotoStyleRenderer",abstractKey:null}}();e.exports=a}),null);
__d("CometRemote3DPhotoViewer_photo.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometRemote3DPhotoViewer_photo",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"immersive_photo_encodings",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"projection_type",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"binary_cdn_uri",storageKey:null}],type:"PhotoEncoding3D",abstractKey:null}],storageKey:null}],type:"Photo",abstractKey:null};e.exports=a}),null);
__d("Comet3DPhotoLoadingOverlay.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){a=a.isVisible;return h.jsx("div",{className:"xy75621 x47corl x10l6tqk xtzzx4i xwa60dl x11lhmoz xippbsu x19991ni xl405pv xni59qk"+(a?"":" xg01cxk"),children:h.jsx("div",{})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("createWebGL3DPhotoProgram",["CometWebGLProgram","Matrices"],(function(a,b,c,d,e,f,g){"use strict";var h="\nattribute vec3 a_position;\nattribute vec2 a_texcoord_0;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 transformMatrix;\nvarying vec2 v_texcoord_0;\n\nvoid main() {\n  v_texcoord_0 = a_texcoord_0;\n  gl_Position = projectionMatrix * viewMatrix * transformMatrix * vec4(a_position, 1.0);\n}\n",i='\nprecision mediump float;\n\nvarying vec2 v_texcoord_0;\nuniform sampler2D u_texture_0;\n\nvoid main() {\n  // LOD refers to "level of detail" and is used for mipmap filtering.\n  // A positive LOD bias samples closer to the less detailed mipmap level,\n  // and a negative LOD bias samples closer to the more detailed mipmap level.\n  const float kLodBias = 0.0;\n  gl_FragColor = texture2D(u_texture_0, v_texcoord_0, kLodBias);\n}\n';function a(a){var b=new(c("CometWebGLProgram"))(a);return b.addShader(h,a.VERTEX_SHADER).addShader(i,a.FRAGMENT_SHADER).compile().setUniformDefaults({projectionMatrix:c("Matrices").createIdentityMat4(),transformMatrix:c("Matrices").createIdentityMat4(),viewMatrix:c("Matrices").createIdentityMat4()})}g["default"]=a}),98);
__d("createMeshesFromGLTF",["CometWebGLMesh","CometWebGLTexture","Promise","createWebGL3DPhotoProgram"],(function(a,b,c,d,e,f,g){"use strict";var h={POSITION:"a_position",TEXCOORD_0:"a_texcoord_0"};function a(a,d){var e=[],f=c("createWebGL3DPhotoProgram")(a),g=[],j=d.getMeshes();for(j of j){var k=j.primitives;for(k of k){var l=k.attributes,m=[],n=Infinity,o=0;for(l of Object.entries(l)){var p=l[0],q=l[1];if(typeof q==="number"){q=d.getAccessor(q);var r=d.getBufferView(q.bufferView);r.byteOffset<n&&(n=r.byteOffset);r.byteOffset+r.byteLength>o&&(o=r.byteOffset+r.byteLength);q=q.byteOffset!=null?q.byteOffset:0;m.push({byteOffset:r.byteOffset+q,name:p})}}m.sort(i);var s=new(c("CometWebGLMesh"))(a,f,{interleaved:!1});r=d.getBinarySource();for(q of m)if(q.name in h){p=q.byteOffset-n;l={offset:p};s.addAttribute(h[q.name],l)}s.bufferData(new Float32Array(r.buffer,r.byteOffset+n,(o-n)/4));k.indices!=null&&s.bufferIndex(d.getDataViewForAccessor(k.indices));if(k.material!=null){m=d.getMaterial(k.material);var t=m==null?void 0:(p=m.pbrMetallicRoughness)==null?void 0:(l=p.baseColorTexture)==null?void 0:l.index;t!=null&&(function(){var e=d.getTexture(t),f=d.getImage(e.source),h=new(c("CometWebGLTexture"))(a,{generateMipmaps:!0});g.push(new(b("Promise"))(function(a,b){f.onload=function(){h.setSource(f),a()},f.onerror=function(){b()}}));s.setUniform("u_texture_0",h)})()}e.push(s)}}return b("Promise").all(g).then(function(){return e})}function i(a,b){return a.byteOffset-b.byteOffset}g["default"]=a}),98);
__d("glVec3CrossProduct",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}f["default"]=a}),66);
__d("glMatrixLookingAtTarget",["glVec3CrossProduct"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b=[a[0]-b[0],a[1]-b[1],a[2]-b[2]];var d=Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]);b[0]/=d;b[1]/=d;b[2]/=d;d=c("glVec3CrossProduct")([0,1,0],b);var e=c("glVec3CrossProduct")(b,d);return[d[0],d[1],d[2],0,e[0],e[1],e[2],0,b[0],b[1],b[2],0,a[0],a[1],a[2],1]}g["default"]=a}),98);
__d("GLTFResource",["unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=[],this.$2=[],this.$3=null,this.$4=null,this.$5=[],this.$6=[],this.$7=[],this.$8=[]}var b=a.prototype;b.addBinarySource=function(a,b,c){this.$3=new Uint8Array(a,b,c)};b.useJSON=function(a){var b;this.$4=(b=a.extras)!=null?b:Object.freeze({});this.$1=(b=a.accessors)!=null?b:[];this.$2=(b=a.bufferViews)!=null?b:[];this.$5=(b=a.images)!=null?b:[];this.$6=(b=a.materials)!=null?b:[];this.$7=(b=a.meshes)!=null?b:[];this.$8=(b=a.textures)!=null?b:[]};b.getBinarySource=function(){if(this.$3==null)throw c("unrecoverableViolation")("attempted to access binary source before it was set","webgl");return this.$3};b.hasBinarySource=function(){return this.$3!=null};b.getAccessor=function(a){a=this.$1[a];if(a==null)throw c("unrecoverableViolation")("accessor index out of range","webgl");return a};b.getBufferView=function(a){a=this.$2[a];if(a==null)throw c("unrecoverableViolation")("buffer view index out of range","webgl");return a};b.getExtras=function(){return this.$4};b.getMaterial=function(a){a=this.$6[a];if(a==null)throw c("unrecoverableViolation")("material index out of range","webgl");return a};b.getMeshes=function(){return this.$7};b.getTexture=function(a){a=this.$8[a];if(a==null)throw c("unrecoverableViolation")("texture index out of range","webgl");return a};b.getDataViewForAccessor=function(a){a=this.$1[a];if(a==null)throw c("unrecoverableViolation")("accessor index out of range","webgl");var b=this.$2[a.bufferView];if(b==null)throw c("unrecoverableViolation")("buffer view index out of range","webgl");if(b.buffer!==0)throw c("unrecoverableViolation")("external gltf buffers are not currently supported","webgl");var d=this.$3;if(d==null)throw c("unrecoverableViolation")("attempted to get an accessor before loading binary data","webgl");var e=d.byteOffset+b.byteOffset;switch(a.componentType){case 5120:return new Int8Array(d.buffer,e,b.byteLength);case 5121:return new Uint8Array(d.buffer,e,b.byteLength);case 5122:return new Int16Array(d.buffer,e,b.byteLength/2);case 5123:return new Uint16Array(d.buffer,e,b.byteLength/2);case 5124:return new Int32Array(d.buffer,e,b.byteLength/4);case 5125:return new Uint32Array(d.buffer,e,b.byteLength/4);case 5126:return new Float32Array(d.buffer,e,b.byteLength/4);default:throw c("unrecoverableViolation")("unsupported gl component type","webgl")}};b.getImage=function(a){a=this.$5[a];var b=this.getBufferView(a.bufferView),c=this.getBinarySource();c=new Uint8Array(c.buffer,c.byteOffset+b.byteOffset,b.byteLength);b=new Blob([c],{type:a.mimeType});c=URL.createObjectURL(b);a=new Image();a.src=c;return a};return a}();g["default"]=a}),98);
__d("GLTFTypesValidator",["unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function h(a){throw c("unrecoverableViolation")("unrecoverable incorrectly formatted JSON ".concat(a),"webgl")}function i(a){a===void 0&&h("GLTFAccessor undefined"),s(a.bufferView,!0,"GLTFAccessor.bufferView",0),s(a.byteOffset,!1,"GLTFAccessor.byteOffset",0),s(a.componentType,!0,"GLTFAccessor.componentType",5120,5126),s(a.count,!0,"GLTFAccessor.count",1),a.type!==void 0&&(a.type!=="SCALAR"&&a.type!=="VEC2"&&a.type!=="VEC3"&&a.type!=="VEC4"&&h("GLTFAccessor malformed"))}function j(a){k(a,!0,"GLTFAccessor");if(a!==void 0)for(a of a)i(a)}function k(a,b,c){if(a===void 0)if(b)h("Array<".concat(c).concat("> undefined"));else return;else a.length===0&&h("Array<".concat(c).concat("> length=0"))}function a(a,b,c){if(a===void 0)if(b)h(c.concat(" undefined"));else return;typeof a!=="boolean"&&h(c.concat(" not a boolean"))}function l(a){a===void 0&&h("GLTFBuffer undefined"),s(a.byteLength,!0,"GLTFBuffer.byteLength",1)}function m(a){s(a.buffer,!0,"GLTFBufferView.buffer",0),s(a.byteOffset,!0,"GLTFBufferView.byteOffset",0),s(a.byteLength,!0,"GLTFBufferView.byteLength",0)}function n(a){k(a,!1,"GLTFBufferView");if(a!==void 0)for(a of a)m(a)}function o(a){k(a,!1,"GLTFBuffer");if(a!==void 0)for(a of a)l(a)}function p(a){a!==void 0&&(a.FB_PHOTO_3D_DATA!==void 0?(a.FB_PHOTO_3D_DATA.hFov!==void 0&&s(a.FB_PHOTO_3D_DATA.hFov,!1,"GLTFExtras.FB_PHOTO_3D_DATA.hFov"),a.FB_PHOTO_3D_DATA.vFov!==void 0&&s(a.FB_PHOTO_3D_DATA.vFov,!1,"GLTFExtras.FB_PHOTO_3D_DATA.vFov")):h("GLTFExtras undefined"))}function b(a){a!==void 0?(j(a.accessors),o(a.buffers),n(a.bufferViews),p(a.extras),r(a.images),u(a.materials),w(a.meshes),B(a.textures)):h("GLTFBody undefined")}function q(a){a===void 0&&h("GLTFImage undefined"),z(a.mimeType,!0,"GLTFImage.mimeType"),s(a.bufferView,!0,"GLTFImage.bufferView",0)}function r(a){k(a,!1,"GLTFImage");if(a!==void 0)for(a of a)q(a)}function s(a,b,c,d,e){d===void 0&&(d=Number.MIN_SAFE_INTEGER);e===void 0&&(e=Number.MAX_SAFE_INTEGER);if(a===void 0)if(b)h(c.concat(" undefined"));else return;typeof a==="number"?(a<d||a>e)&&h(c.concat(" out of range")):h(c.concat(" not an integer"))}function t(a){a===void 0&&h("GLTFMaterial undefined"),a.pbrMetallicRoughness!==void 0&&(a.pbrMetallicRoughness.baseColorTexture!==void 0&&s(a.pbrMetallicRoughness.baseColorTexture.index,!1,"GLTFMaterial.pbrMetallicRoughness.baseColorTexture.index",0))}function u(a){k(a,!1,"GLTFMaterial");if(a!==void 0)for(a of a)t(a)}function v(a){a===void 0&&h("GLTFMesh undefined"),y(a.primitives)}function w(a){k(a,!0,"GLTFMesh");if(a!==void 0)for(a of a)v(a)}function x(a){a===void 0&&h("GLTFPrimitive undefined");for(var b in a.attributes)Object.prototype.hasOwnProperty.call(a.attributes,b)&&(b==="POSITION"||b==="TEXCOORD_0"||b==="TEXCOORD_1"?s(a.attributes[b],!0,"GLTFPrimitives.attributes[".concat(b).concat("]"),0):h("GLTFPrimitive malformed"));s(a.indices,!1,"GLTFPrimitives.indicies",0);s(a.material,!1,"GLTFPrimitives.material",0)}function y(a){a===void 0&&h("GLTFPrimatives undefined");k(a,!0,"GLTFPrimitive");for(a of a)x(a)}function z(a,b,c){if(a===void 0)if(b)h(c.concat(" undefined"));else return;typeof a!=="string"&&h(c.concat(" not a string"))}function A(a){a===void 0&&h("GLTFTexture undefined"),s(a.sampler,!0,"GLTFTexture.sampler",0),s(a.source,!0,"GLTFTexture.source",0)}function B(a){k(a,!0,"GLTFTexture");if(a!==void 0)for(a of a)A(a)}g.throwBadFormat=h;g.validateAccessor=i;g.validateAccessors=j;g.validateArray=k;g.validateBoolean=a;g.validateBuffer=l;g.validateBufferView=m;g.validateBufferViews=n;g.validateBuffers=o;g.validateExtras=p;g.validateGLTFBodyJSON=b;g.validateImage=q;g.validateImages=r;g.validateInteger=s;g.validateMaterial=t;g.validateMaterials=u;g.validateMesh=v;g.validateMeshes=w;g.validatePrimitive=x;g.validatePrimitives=y;g.validateString=z;g.validateTexture=A;g.validateTextures=B}),98);
__d("extractUTF8StringFromBuffer",["EndianAwareDataReader","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a>127}function i(a){return a>=192&&a<=223}function j(a){return a>=224&&a<=239}function k(a){return a>=240&&a<=247}function a(a,b,d){if(b+d>a.byteLength)throw c("unrecoverableViolation")("offset and length exceed ArrayBuffer bounds","webgl");if("TextDecoder"in window){var e=new TextDecoder("utf-8"),f=new Uint8Array(a,b,d);return e.decode(f)}e=new(c("EndianAwareDataReader"))(a.slice(b,b+d),!1);f=[];while(e.canReadU8()){a=e.readU8();if(h(a))if(i(a)){if(!e.canReadU8())throw c("unrecoverableViolation")("incomplete two-byte utf8 sequence","webgl");b=e.readU8();a=(a&31)<<6|b&63}else if(j(a)){d=e.canReadU8()?e.readU8():null;b=e.canReadU8()?e.readU8():null;if(d==null||b==null)throw c("unrecoverableViolation")("incomplete three-byte utf8 sequence","webgl");a=(a&15)<<12|(d&63)<<6|b&63}else if(k(a)){d=e.canReadU8()?e.readU8():null;b=e.canReadU8()?e.readU8():null;var g=e.canReadU8()?e.readU8():null;if(d==null||b==null||g==null)throw c("unrecoverableViolation")("incomplete four-byte utf8 sequence","webgl");a=(a&7)<<18|(d&63)<<12|(b&63)<<6|g&63}else throw c("unrecoverableViolation")("unknown utf8 start sequence","webgl");if(a<=65535)f.push(String.fromCharCode(a));else if(a<=1114111)a-=65536,f.push(String.fromCharCode(a>>10|55296)),f.push(String.fromCharCode(a&1023|56320));else throw c("unrecoverableViolation")("codepoint is beyond ","webgl")}return f.join("")}g["default"]=a}),98);
__d("parseGLBResource",["GLTFResource","GLTFTypesValidator","extractUTF8StringFromBuffer","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h=1179937895;function a(a){var b=new DataView(a);if(b.getUint32(0,!0)!==h)throw c("unrecoverableViolation")("invalid GLB magic number","webgl");if(b.getUint32(4,!0)!==2)throw c("unrecoverableViolation")("unsupported GLB version number","webgl");var e=b.getUint32(8,!0);if(e>a.byteLength)throw c("unrecoverableViolation")("glb buffer is shorter than declared byte length","webgl");var f=new(c("GLTFResource"))(),g=12;while(g<e){var i=b.getUint32(g,!0),j=b.getUint32(g+4,!0);switch(j){case 1313821514:j=c("extractUTF8StringFromBuffer")(a,g+8,i);var k="";try{k=JSON.parse(j)}catch(a){throw c("unrecoverableViolation")("failed to parse glTF JSON","webgl",a)}d("GLTFTypesValidator").validateGLTFBodyJSON(k);f.useJSON(k);break;case 5130562:f.addBinarySource(a,g+8,i);break;default:throw c("unrecoverableViolation")("unexpected GLB section label","webgl")}g+=i+8}return f}g["default"]=a}),98);
__d("useGLBLoadAndParse",["parseGLBResource","promiseDone","react"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useEffect,i=b.useState;function a(a){var b=i(null),d=b[0],e=b[1];h(function(){var b=!1;c("promiseDone")(window.fetch(a).then(function(a){return a.arrayBuffer()}).then(function(a){if(b)return;a=c("parseGLBResource")(a);e(a)})["catch"](function(){e(null)}));return function(){b=!0}},[a]);return d}g["default"]=a}),98);
__d("useGLTFDerivedFOV",["react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react").useMemo,i=1,j=.508015513,k=.666488587,l=.925,m=Object.freeze({landscape:-.14,portrait:-.124}),n=Object.freeze({landscape:-.124,portrait:-.112}),o=Object.freeze({landscape:.96,portrait:.8}),p=Object.freeze({landscape:.6,portrait:.7});function a(a){var b=h(function(){var b;b=(b=a==null?void 0:(b=a.getExtras())==null?void 0:(b=b.FB_PHOTO_3D_DATA)==null?void 0:b.vFov)!=null?b:k;return b*l},[a]),c=h(function(){var b;b=(b=a==null?void 0:(b=a.getExtras())==null?void 0:(b=b.FB_PHOTO_3D_DATA)==null?void 0:b.hFov)!=null?b:j;return b*l},[a]),d=h(function(){var a=.1,d=1e3,e=1/Math.tan(b/2),f=c/b;return[e/f,0,0,0,0,e,0,0,0,0,(a+d)/(a-d),-1,0,0,a*d*2/(a-d),0]},[c,b]),e=h(function(){var a=c>b?"landscape":"portrait",d=m[a],e=n[a];return[Math.tan(c/2)*i*d,Math.tan(b/2)*i*e,1-o[a],p[a]]},[c,b]),f=e[0],g=e[1],q=e[2];e=e[3];return{hFov:c,maxHorizontalAngle:f,maxVerticalAngle:g,projectionMatrix:d,targetInteractionWeightHorizontal:q,targetScrollWeightVertical:e,vFov:b}}g["default"]=a}),98);
__d("Comet3DPhotoViewer.react",["fbt","CometFeedStoryImmersiveMediaMouseOverlay.react","CometLazyPopoverTrigger.react","ConstUriUtils","JSResourceForInteraction","Matrices","UserAgent","clearTimeout","cr:214","createMeshesFromGLTF","getCometPrefersReducedMotion","gkx","glMatrixLookingAtTarget","mergeRefs","promiseDone","react","setTimeout","useFrameTiming","useGLBLoadAndParse","useGLContext","useGLTFDerivedFOV","useResizeObserver","useThrottled","useVisibilityObserver"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");e=d("react");var j=e.useCallback,k=e.useEffect,aa=e.useMemo,l=e.useRef,m=e.useState,ba=c("JSResourceForInteraction")("CometFeedStory3DPhotoContextMenu.react").__setRef("Comet3DPhotoViewer.react"),n=1,o=.01,ca=.005,da=.1,p=.06,ea=.12,q=c("getCometPrefersReducedMotion")()?.25:1;function a(a){var e=a.aspectRatio,f=a.fallbackURI,g=a.fileURI,r=a.onLoad,s=a.photoID;a=a.storyContext;var t=c("gkx")("678680"),u=m(!1),v=u[0],w=u[1],x=l(null),y=i.createRef();u=m(1024);var z=u[0],A=u[1];u=c("useGLContext")(z,Math.ceil(z/e),{expand:!0,stencil:!0});var B=u[0],C=u[1];z=c("useFrameTiming")();var D=z[0],E=c("useGLBLoadAndParse")(g);e=m([]);var F=e[0],fa=e[1];k(function(){if(B==null||E==null)return;var a=!1;c("promiseDone")(c("createMeshesFromGLTF")(B,E).then(function(b){if(a)return;fa(b);r&&r();D(W)}));return function(){a=!0}},[B,E,r]);u=c("useGLTFDerivedFOV")(E);var G=u.hFov,H=u.maxHorizontalAngle,I=u.maxVerticalAngle,J=u.projectionMatrix,K=u.targetInteractionWeightHorizontal,L=u.targetScrollWeightVertical,M=u.vFov,N=j(function(){if(B==null||F.length===0)return;B.enable(B.DEPTH_TEST);B.clear(B.COLOR_BUFFER_BIT|B.DEPTH_BUFFER_BIT);B.enable(B.BLEND);B.blendFunc(B.SRC_ALPHA,B.ONE_MINUS_SRC_ALPHA);for(var a of F)a.program.use(),a.draw()},[F,B]),ga=function(){c("clearTimeout")(x.current),x.current=c("setTimeout")(function(){w(!0)},3e3)};z=function(){v&&w(!1),ga()};var O=c("useThrottled")(z,100),P=c("useVisibilityObserver")({onVisible:function(){c("clearTimeout")(x.current),x.current=c("setTimeout")(function(){w(!0)},3e3)}});k(function(){return function(){c("clearTimeout")(x.current)}},[]);var Q=l([0,0]),R=l(1),S=l(1),T=l([0,0]),U=l([0,0]),V=l(0),W=j(function(a){if(B==null)return;if(a!=null){if(V.current!==0){var b=Math.min(a-V.current,50);b=Math.max(Math.min(ca*b,1),0);var d=T.current,e=d[0];d=d[1];var f=U.current,g=f[0];f=f[1];U.current=[g+b*(e-g),f+b*(d-f)];g=R.current;f=S.current;S.current=f+b*(g-f);(Math.abs(U.current[0]-e)>o||Math.abs(U.current[1]-d)>o||Math.abs(S.current-g)>o)&&D(W)}V.current=a}b=S.current;f=M*ea*(2*b-1)*q;e=(1-2*b)*I;d=U.current;g=d[0];a=d[1];d=Math.sin(g*Math.PI*.5*q);g=Math.sin(a*Math.PI*.5*q);a=M*p*g;var h=G*p*d;d=-d*H;g=-g*I;b=Math.pow(b+.16,3)/(Math.pow(b+.16,3)+Math.pow(1-(b+.16),3))-.9;a=-(a+f);f=-h;h=n-b*da*q;b=[0+h*Math.cos(a)*Math.sin(f),0+h*Math.sin(a),-n+h*Math.cos(a)*Math.cos(f)];h=[-(K*d),-(e*L+g*(1-L)),-n];a=c("glMatrixLookingAtTarget")(b,h);f=c("Matrices").invertMat4(a);for(d of F)d.setUniform("viewMatrix",f),d.setUniform("projectionMatrix",J);N()},[N,B,G,H,I,F,J,D,K,L,M]);k(function(){var a=y==null?void 0:y.current;if(a==null)return;a=a.clientWidth;a!=null&&A(a)},[y]);var X=c("useResizeObserver")(function(a){A(Math.floor(a.width))}),Y=j(function(){if(B==null)return;var a=B.canvas,b=0,c=0;while(a!=null)b+=a instanceof HTMLElement?a.offsetLeft:0,c+=a instanceof HTMLElement?a.offsetTop:0,a=a instanceof HTMLElement?a.offsetParent:null;Q.current=[b,c]},[Q,B]),Z=j(function(){var a;if(B==null)return;Y();var b=window.innerHeight,c=B.canvas.clientHeight;b=b+c;a=Q.current[1]-((a=(a=document.scrollingElement)==null?void 0:a.scrollTop)!=null?a:0)+c;c=a/b;R.current=c;if(c<0||c>1)return;D(W)},[Q,B,D,W,Y]);e=j(function(a){if(B==null)return;Y();var b=a.pageX;a=a.pageY;b=b-Q.current[0];a=a-Q.current[1];b=2*b/B.canvas.clientWidth-1;a=1-2*a/B.canvas.clientHeight;T.current=[b,a];O();if(b<-1||a<-1||b>1||a>1)return;D(W)},[B,T,D,O,W,Y]);k(function(){document.addEventListener("scroll",Z);W();return function(){document.removeEventListener("scroll",Z)}},[W,Z]);var $,ha;if(s!=null){$=(u=d("ConstUriUtils").getUri("/intern/compphoto/x3d/3dphoto_console"))==null?void 0:(z=u.setDomain("our.intern.facebook.com"))==null?void 0:(u=z.setProtocol("https"))==null?void 0:(z=u.addQueryParam("ent_id",s))==null?void 0:z.toString();ha=(u=d("ConstUriUtils").getUri("/intern/compphoto/x3d/"+s+"/depth"))==null?void 0:(z=u.setDomain("our.intern.facebook.com"))==null?void 0:(s=z.setProtocol("https"))==null?void 0:s.toString()}u=m(0);z=u[0];var ia=u[1];s=m(0);u=s[0];var ja=s[1],ka=function(a,b){var d=/^a$/i.test(a.target.nodeName||""),e=c("UserAgent").isPlatform("Mac OS X")?a.metaKey:a.ctrlKey;d=!d&&t&&e;d&&(ia(a.nativeEvent.offsetX),ja(a.nativeEvent.offsetY),a.preventDefault(),b())};s=aa(function(){return c("mergeRefs")(C,P,y,X)},[C,P,y,X]);a=b("cr:214")!=null?i.jsx(b("cr:214"),{fov:[G,M],gl:B,meshes:F,storyContext:a}):null;var la=i.jsxs("div",{onMouseMove:e,ref:s,children:[i.jsx(c("CometFeedStoryImmersiveMediaMouseOverlay.react"),{descriptionFbt:h._("__JHASH__l2tPgC8L6Zy__JHASH__"),isActive:v,showClick:!1}),a]});e=i.jsx(c("CometLazyPopoverTrigger.react"),{popoverProps:{consoleURL:$,depthURL:ha,fallbackImgURL:f,fileURL:g,mouseClickX:z,mouseClickY:u},popoverResource:ba,children:function(a,b){return i.jsx("div",{className:"x1ey2m1c xds687c x10l6tqk x17qophe x13vifvy",onContextMenu:function(a){ka(a,b)},ref:a,children:la})}});return t?e:la}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("CometRemote3DPhotoViewer.react",["Comet3DPhotoLoadingOverlay.react","Comet3DPhotoViewer.react","CometFeedStoryViewportMaxHeightMediaLayout.react","CometRelay","CometRemote3DPhotoViewer_photo.graphql","clearTimeout","react","recoverableViolation","setTimeout","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("react");e=d("react");var j=e.useCallback,k=e.useEffect,l=e.useRef,m=e.useState,n={content:{height:"x5yr21d",position:"x1n2onr6",$$css:!0},image:{bottom:"x1ey2m1c",end:"xds687c",position:"x10l6tqk",start:"x17qophe",top:"x13vifvy",$$css:!0},overlays:{bottom:"x1ey2m1c",end:"xds687c",pointerEvents:"x47corl",position:"x10l6tqk",start:"x17qophe",top:"x13vifvy",$$css:!0},photoContainer:{position:"x1n2onr6",$$css:!0},root:{borderBottom:"xua58t2",borderTop:"xzg4506",boxShadow:"x2qxk11",$$css:!0}};function a(a){var e,f,g=a.fallback,o=a.storyContext,p=d("CometRelay").useFragment(h!==void 0?h:h=b("CometRemote3DPhotoViewer_photo.graphql"),a.photo),q=m(!1),r=q[0],s=q[1];q=m(!1);var t=q[0],u=q[1],v=l(null);k(function(){v.current=c("setTimeout")(function(){u(!0)},2e3);return function(){v.current!=null&&c("clearTimeout")(v.current)}},[]);q=j(function(){s(!0)},[s]);t=!t||!r;p=(r=p==null?void 0:p.immersive_photo_encodings)!=null?r:[];r=p.find(function(a){return(a==null?void 0:a.projection_type)==="three_d"});if(a.glbFileURI==null&&r==null){c("recoverableViolation")("3D photo does not have three_d encoding","comet_feed");return g}a=a.glbFileURI!=null?a.glbFileURI:(p=r==null?void 0:r.binary_cdn_uri)!=null?p:"";r=(p=r==null?void 0:r.id)!=null?p:"";p=(p=g.props.src)!=null?p:"";e=(e=g.props.width)!=null?e:0;f=(f=g.props.height)!=null?f:0;(e===0||f===0)&&c("recoverableViolation")("null fallback size was provided for 3d photo","comet_feed");var w=e===0||f===0?{aspectRatio:1,height:1,width:1}:{aspectRatio:e/f,height:f,width:e};w=w.aspectRatio;var x=a!=null&&c("Comet3DPhotoViewer.react")!=null?i.jsxs("div",{className:"x1n2onr6",children:[i.jsx(c("Comet3DPhotoViewer.react"),{aspectRatio:w,fallbackURI:p,fileURI:a,onLoad:q,photoID:r,storyContext:o}),i.jsx("div",{className:"x1ey2m1c xds687c x47corl x10l6tqk x17qophe x13vifvy",children:i.jsx(c("Comet3DPhotoLoadingOverlay.react"),{isVisible:t})})]}):g;return i.jsx("div",{className:"xua58t2 xzg4506 x2qxk11",children:i.jsx(c("CometFeedStoryViewportMaxHeightMediaLayout.react"),{backgroundColor:null,mediaHeight:f,mediaWidth:e,children:function(a){return i.jsx("div",{className:c("stylex")(n.content,a),children:i.jsx("div",{className:"x1ey2m1c xds687c x10l6tqk x17qophe x13vifvy",children:x})})}})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("useWebGLContextVisibility",["HiddenSubtreePassiveContext","intersectionObserverEntryIsIntersecting","react","useIntersectionObserver"],(function(a,b,c,d,e,f,g){"use strict";d("react");var h=d("react").useContext;function a(a,b){b===void 0&&(b=Object.freeze({}));var d=h(c("HiddenSubtreePassiveContext")),e=function(b){var e=d.getCurrentState().hiddenOrBackgrounded_FIXME;c("intersectionObserverEntryIsIntersecting")(b)?a(!0):e||a(!1)};return c("useIntersectionObserver")(e,babelHelpers["extends"]({root:null,rootMargin:{},threshold:0},b))}g["default"]=a}),98);
__d("CometFeedStory3DPhotoAttachmentStyle.react",["CometFeedStory3DPhotoAttachmentStyle_styleTypeRenderer.graphql","CometImage.react","CometPressable.react","CometRelay","CometRemote3DPhotoViewer.react","getCometMediaURL","gkx","react","unrecoverableViolation","useCometFeedStoryAttachmentMatchDebugger","useWebGLContextVisibility"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("react");e=d("react");var j=e.useMemo,k=e.useState,l={image:{bottom:"x1ey2m1c",end:"xds687c",position:"x10l6tqk",start:"x17qophe",top:"x13vifvy",$$css:!0},mediaPressed:{backgroundColor:"xobhos8",$$css:!0},wrapper:{position:"x1n2onr6",width:"xh8yej3",$$css:!0}},m=c("gkx")("708253");function a(a){var e,f;a=d("CometRelay").useFragment(h!==void 0?h:h=b("CometFeedStory3DPhotoAttachmentStyle_styleTypeRenderer.graphql"),a.styleTypeRenderer);c("useCometFeedStoryAttachmentMatchDebugger")(a);var g=k(!1),n=g[0];g=g[1];g=c("useWebGLContextVisibility")(g,{rootMargin:{bottom:2e3,top:2e3}});a=a.attachment;var o=a==null?void 0:(e=a.description)==null?void 0:e.text;e=a==null?void 0:(e=a.target)==null?void 0:e.container_story;f=e==null?void 0:(f=e.actors)==null?void 0:f[0];var p=f==null?void 0:f.name,q=f==null?void 0:(f=f.profile_picture)==null?void 0:f.uri,r=e==null?void 0:e.creation_time,s=j(function(){if(p!=null&&q!=null&&r!=null&&o!=null)return{actorName:p,actorPhoto:q,description:o,time:r};else return null},[p,q,r,o]),t=a==null?void 0:a.media;if(t==null)throw c("unrecoverableViolation")("media attachment cannot be null in CometFeedStory3DPhotoAttachment","comet_feed");var u=(e=(f=t.photo_image)==null?void 0:f.uri)!=null?e:"",v=(a=t.accessibility_caption)!=null?a:"",w=(e=(f=t.photo_image)==null?void 0:f.height)!=null?e:0,x=(f=(a=t.photo_image)==null?void 0:a.width)!=null?f:0,y=c("getCometMediaURL")(t,null),z=j(function(){return i.jsx(c("CometImage.react"),{alt:v,height:w,src:u,width:x,xstyle:l.image})},[v,w,u,x]);e=j(function(){var a=i.jsx(c("CometRemote3DPhotoViewer.react"),{fallback:z,photo:t,storyContext:s});return i.jsx(c("CometPressable.react"),{hideHoverOverlay:!0,linkProps:{rel:m?void 0:"theater",url:y},overlayPressedStyle:l.mediaPressed,style:{display:"block"},children:a})},[z,t,y,s]);return i.jsx("div",{className:"x1n2onr6 xh8yej3",ref:g,children:n?e:z})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);